@using Program.Models;
@using Program.Define;
@{
    ViewBag.Title = "Page forget";
    Layout = "~/Views/Shared/_Layout.cshtml";
    string email = ViewBag.email;
    string code = ViewBag.code;
    string error = ViewBag.error;
    ViewBag.pageNow =
        new LocationPage(DefinePage.home,
            new LocationPage(DefinePage.user,
                new LocationPage(DefinePage.user_ForgetPassword)));
}
<link href="~/Content/style/userstyle.css" rel="stylesheet" />
<section class="vh-100">
    <div class="container" style="margin: 0; max-width: 100%">
        <div class="row d-flex justify-content-center align-items-center h-100">
            <div class="col-lg-12" style="padding: 0">
                <div class="card text-black" style="border-radius: 25px;">
                    <div class="card-body p-md-5">
                        <div class="row justify-content-center">
                            <div class="col-md-10 col-lg-6 col-xl-5 order-2 order-lg-1">
                                <p class="text-center h1 fw-bold mb-1-5 mx-1 mx-md-4 mt-4">@DefinePage.user_ForgetPassword.name</p>
                                <div class="alert alert-danger alert-dismissible fade show @(error == null ? "d-none" : "")" role="alert">
                                    @error
                                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                                </div>
                                <form id="form" action="@DefinePage.user_ForgetPassword.url" method="post" class="d-flex flex-row mb-4 justify-content-around flex-column input-info">
                                    <p class="text-danger" id="errorRadio"></p>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="radio" id="radio-id" style="border-color: #959595" onchange="useId()">
                                        <label class="form-check-label" for="radio-id">
                                            Use id
                                        </label>
                                    </div>
                                    <div class="d-flex flex-row align-items-center input-code flex-row">
                                        <div class="form-outline flex-fill mb-0">
                                            <input type="text" id="code" class="input form-control" name="code" placeholder="Input your id" value="" disabled="disabled" />
                                            <p class="text-danger" id="errorCode"></p>
                                        </div>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="radio" id="radio-email" style="border-color: #959595;" onchange="useEmail()">
                                        <label class="form-check-label" for="radio-email">
                                            Use email
                                        </label>
                                    </div>
                                    <div class="d-flex flex-row align-items-center input-email flex-row" disable="true">
                                        <div class="form-outline flex-fill mb-0">
                                            <input type="email" id="email" class="input form-control" name="email" placeholder="Input your email" value="" disabled="disabled" />
                                            <p class="text-danger" id="errorEmail"></p>
                                        </div>
                                    </div>
                                    <div class="d-flex mx-4 mb-3 mb-lg-4 flex-wrap" style="justify-content: space-evenly;">
                                        <a href="#">
                                            <button type="button" class="btn btn-primary btn-lg" id="btn-submit" style="background-color:#0D6EFD; border: 0;">
                                                Send
                                            </button>
                                        </a>
                                        <a href="~/Home/Index">
                                            <button type="button" class="btn btn-primary btn-lg" style="background-color:#808080; border: 0;">
                                                Cancel
                                            </button>
                                        </a>
                                    </div>
                                </form>
                            </div>
                            <div class="col-md-10 col-lg-6 col-xl-7 d-flex align-items-center order-1 order-lg-2">

                                <img src="~/Content/imgs/img-of-login.jpg"
                                     class="img-fluid" alt="Sample image">

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    const validateEmail = (email) => {
        return String(email)
            .toLowerCase()
            .match(
                /^(([^<>()[\]\\.,;:\s@@"]+(\.[^<>()[\]\\.,;:\s@@"]+)*)|.(".+"))@@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/
            );
    };
    $(document).ready(function () {
        $('#code').keypress(function () {
            $('#errorCode').text("")
        })
        $('#email').keypress(function () {
            $('#errorEmail').text("")
        })
    });
    $('#btn-submit').click(function () {
        var useCode = ($('#radio-id').attr('checked') == 'checked' ? true : false);
        var useEmail = ($('#radio-email').attr('checked') == 'checked' ? true : false);
        var code = $('#code').val();
        var email = $('#email').val();
        if (useCode) {
            let length = code.length;
            if (length <= 0 || length > 10) {
                if (length <= 0)
                    $('#errorCode').text("Trường này không được phép để trống");
                else
                    $('#errorCode').text('Mã code không được vượt quá 10 ký tự');
                return;
            }
        } else if (useEmail) {
            let length = email.length;
            if (length <= 0 || validateEmail(email) == null) {
                if (length <= 0)
                    $('#errorEmail').text("Trường này không được phép để trống");
                else
                    $('#errorEmail').text("Email bạn nhập không đúng định dạng");
                return;
            }
        } else {
            $('#errorRadio').text("Bạn phải chọn một trong hai lựa chọn dưới");
            return;
        }
        $('#form').submit();
    });
    function useId() {
        $('#radio-id').attr('checked', 'checked');
        $('#radio-email').attr('checked', null);
        $('#code').attr('disabled', null);
        $('#email').attr('disabled', 'disabled');
        $('#email').val('');
        $('#errorEmail').text('');
        $('#errorRadio').text('');
    };
    function useEmail() {
        $('#radio-email').attr('checked', 'checked');
        $('#radio-id').attr('checked', null);
        $('#code').attr('disabled', 'disabled');
        $('#email').attr('disabled', null);
        $('#code').val('');
        $('#errorCode').text('');
        $('#errorRadio').text('');
    };
</script>
